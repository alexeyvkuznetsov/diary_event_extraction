# Автоматическое извлечение событий из исторических дневников (Революции 1848-1849 гг.)

Этот проект предназначен для автоматического анализа текстов дневниковых записей с целью извлечения упоминаний о революционных событиях 1848-1849 гг. в Европе и их восприятия автором. Для анализа используются модели Google Generative AI (Gemini).

## Особенности

*   **Двухэтапная обработка:** Извлечение информации и последующая верификация с помощью LLM.
*   **Карта Знаний:** Использование предопределенной иерархической карты для классификации событий.
*   **Структурированный вывод:** Результаты сохраняются в формате JSON с использованием Pydantic для валидации данных.
*   **Возобновляемость:** Скрипт может быть перезапущен и продолжит работу с места остановки.
*   **Логирование:** Подробное логирование процесса в файл `processing.log` и в консоль.
*   **Управление API:** Встроенный механизм для соблюдения лимитов API.

## Требования

*   Python 3.8+
*   Аккаунт Google AI Studio и API-ключ для Gemini.
*   Библиотеки, перечисленные в `requirements.txt`.

## Установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone [URL вашего репозитория]
    cd [название-директории-репозитория]
    ```

2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python -m venv venv
    # Windows
    venv\Scripts\activate
    # macOS/Linux
    source venv/bin/activate
    ```

3.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Настройте переменные окружения:**
    Скопируйте `.env.example` в `.env`:
    ```bash
    cp .env.example .env
    ```
    Откройте файл `.env` и укажите ваш `GEMINI_API_KEY`.

5.  **Подготовьте данные:**
    *   Поместите CSV-файл с дневниковыми записями (по умолчанию `diary_with_id.csv`) в директорию `data/` или укажите правильный путь в скрипте (`DATA_PATH`). Файл должен содержать колонки `entry_id`, `date`, `text`.
    *   Убедитесь, что файл `knowledge_map.json` находится в корневой директории проекта (или путь к нему корректно указан в `KNOWLEDGE_MAP_PATH`).

## Запуск скрипта

Выполните скрипт из корневой директории проекта:
```bash
python src/info_extraction_revised.py